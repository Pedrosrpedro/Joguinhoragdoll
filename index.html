<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ragdoll Sandbox</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <div id="aspect-ratio-wrapper">
        <div id="root-container">

            <!-- Telas de Menu e Mapas -->
            <div id="main-menu">
                <div class="main-menu-list">
                    <button id="main-menu-play">jogar</button>
                    <button id="main-menu-settings">configurações</button>
                    <button id="main-menu-mods">mods</button>
                    <button id="main-menu-information">informações</button>
                    <button id="main-menu-quit">sair</button>
                </div>
                <div class="main-menu-title">
                    <h1>Ragdoll Sandbox</h1>
                </div>
            </div>

            <div id="map-selection-screen">
                <h2>Selecione um Mapa</h2>
                <div class="map-grid-container">
                    <button class="map-preview-btn" data-map="padrao"><div class="map-preview-visual"></div><span class="map-name">Padrão</span></button>
                    <button class="map-preview-btn" data-map="pequeno"><div class="map-preview-visual"></div><span class="map-name">Pequeno</span></button>
                    <button class="map-preview-btn" data-map="grande"><div class="map-preview-visual"></div><span class="map-name">Grande</span></button>
                    <button class="map-preview-btn" data-map="montanhas"><div id="montanhas-visual" class="map-preview-visual"><div class="mountain m1"></div><div class="mountain m2"></div><div class="mountain m3"></div></div><span class="map-name">Montanhas</span></button>
                    <button class="map-preview-btn" data-map="agua"><div id="agua-visual" class="map-preview-visual"><div class="ground"></div><div class="water"></div></div><span class="map-name">Água</span></button>
                    <button class="map-preview-btn" data-map="predio"><div id="predio-visual" class="map-preview-visual"><div class="building-wall bw1"></div><div class="building-wall bw2"></div><div class="building-wall bw3"></div></div><span class="map-name">Prédio</span></button>
                    <button class="map-preview-btn" data-map="abismo"><div id="abismo-visual" class="map-preview-visual"><div class="platform p1"></div><div class="platform p2"></div></div><span class="map-name">Abismo</span></button>
                </div>
            </div>

            <!-- Container Principal do Jogo -->
            <div id="game-container">
                <div id="top-bar">
                    <button id="icon-items-basic" class="active-category-icon" title="Itens Básicos">📦</button>
                    <button id="icon-melee" title="Armas Brancas">⚔️</button>
                    <button id="icon-explosives" title="Explosivos">💣</button>
                    <button id="icon-people" title="Seres Vivos">🧍</button>
                    <button id="icon-vehicles" title="Veículos">🚗</button>
                    <button id="icon-syringes" title="Seringas">💉</button>
                    <button id="icon-mechanisms" title="Mecanismos">⚙️</button>
                    <button id="icon-tools" title="Ferramentas">🔧</button>
                    <button id="icon-save" title="Salvar Seleção">💾</button>
                    <button id="icon-load" title="Carregar Criação">📂</button>
                </div>

                <div id="left-sidebar">
                    <div class="filter-bar">
                        <input type="text" id="filter-input" placeholder="filtrar">
                        <button class="clear-filter">✖</button>
                    </div>
                    <div id="item-grid-wrapper">
                        <!-- Itens Básicos -->
                        <div id="category-items-basic" class="item-category active">
                            <div class="category-label">Itens</div>
                            <div class="item-grid">
                                <button class="item-btn active-create-type" data-tipo="mao">🖐️</button>
                                <button class="item-btn" data-tipo="caixa">📦</button>
                                <button class="item-btn" data-tipo="bola">🏀</button>
                                <button class="item-btn" data-tipo="barril">🛢️</button>
                                <button class="item-btn" data-tipo="parede">🧱</button>
                                <button class="item-btn" data-tipo="triangulo">🔺</button>
                                <button class="item-btn" data-tipo="cano">➖</button>
                            </div>
                        </div>
                        <!-- Armas Brancas -->
                        <div id="category-melee" class="item-category">
                            <div class="category-label">Armas Brancas</div>
                            <div class="item-grid">
                                <button class="item-btn" data-tipo="lamina">🔪</button>
                                <button class="item-btn" data-tipo="espada">⚔️</button>
                                <button class="item-btn" data-tipo="marreta">🔨</button>
                            </div>
                        </div>
                         <!-- Explosivos -->
                        <div id="category-explosives" class="item-category">
                            <div class="category-label">Explosivos</div>
                            <div class="item-grid">
                                <button class="item-btn" data-tipo="granada">💣</button>
                                <button class="item-btn" data-tipo="c4">🧨</button>
                            </div>
                        </div>
                        <!-- Seres Vivos -->
                        <div id="category-people" class="item-category">
                            <div class="category-label">Seres Vivos</div>
                            <div class="item-grid">
                                <button class="item-btn" data-tipo="boneco">🧍</button>
                            </div>
                        </div>
                        <!-- Veículos -->
                        <div id="category-vehicles" class="item-category">
                            <div class="category-label">Veículos</div>
                            <div class="item-grid">
                                <button class="item-btn" data-tipo="carro">🚗</button>
                                <button class="item-btn" data-tipo="onibus">🚌</button>
                            </div>
                        </div>
                        <!-- Seringas -->
                        <div id="category-syringes" class="item-category">
                            <div class="category-label">Seringas</div>
                            <div class="item-grid">
                                <button class="item-btn" data-tipo="seringa_vazia" title="Seringa Vazia">💉</button>
                                <button class="item-btn" data-tipo="seringa_sangue" title="Seringa de Sangue">🩸</button>
                                <button class="item-btn" data-tipo="seringa_acido" title="Seringa de Ácido">🧪</button>
                                <button class="item-btn" data-tipo="seringa_adrenalina" title="Seringa de Adrenalina">⚡</button>
                                <button class="item-btn" data-tipo="seringa_cura" title="Seringa de Cura Vital">❤️</button>
                                <button class="item-btn" data-tipo="seringa_zumbi" title="Seringa de Zumbi">🧟</button>
                                <button class="item-btn" data-tipo="seringa_imortalidade" title="Seringa de Imortalidade">✨</button>
                                <button class="item-btn" data-tipo="seringa_fogo" title="Seringa de Fogo">🔥</button>
                                <button class="item-btn" data-tipo="seringa_nitro" title="Seringa de Nitroglicerina">💥</button>
                                <button class="item-btn" data-tipo="seringa_antigravidade" title="Seringa Anti-Gravidade">🎈</button>
                                <button class="item-btn" data-tipo="seringa_petrificacao" title="Seringa de Petrificação">🗿</button>
                                <button class="item-btn" data-tipo="seringa_crescimento" title="Seringa de Crescimento">🔼</button>
                                <button class="item-btn" data-tipo="seringa_encolhimento" title="Seringa de Encolhimento">🔽</button>
                            </div>
                        </div>
                        <!-- Mecanismos -->
                        <div id="category-mechanisms" class="item-category">
                            <div class="category-label">Mecanismos</div>
                            <div class="item-grid">
                                <button class="item-btn" data-tipo="gerador" title="Gerador">🔋</button>
                                <button class="item-btn" data-tipo="botao" title="Botão">🔘</button>
                                <button class="item-btn" data-tipo="propulsor" title="Propulsor">🚀</button>
                                <button class="item-btn" data-tipo="pistao" title="Pistão">🔩</button>
                            </div>
                        </div>
                        <!-- Ferramentas -->
                        <div id="category-tools" class="item-category">
                            <div class="category-label">Ferramentas</div>
                            <div class="item-grid full-width">
                                <button id="slowMoButton" class="tool-btn">CÂMERA LENTA</button> 
                                <button id="freezeToggleButton" class="tool-btn">CONGELAR</button>
                                <button class="tool-btn" data-tipo="corda">Corda ⛓️</button> 
                                <button class="tool-btn" data-tipo="cabo_eletrico">Cabo ⚡</button>
                                <button class="tool-btn" data-tipo="mola">Mola 〰️</button>
                                <button class="tool-btn" data-tipo="prego">Prego/Solda ➕</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="bottom-bar">
                    <button id="settings-button">Configurações</button>
                    <button id="environment-button">Ambiente</button>
                    <button id="btnClearAll">Limpar Tudo</button>
                </div>
                
                <div id="mobile-controls">
                    <!-- Controles Mobile -->
                </div>

                <div id="floating-tool-panel"></div>
            </div>

            <!-- Modais -->
            <div id="settings-modal" class="game-modal">
                <div class="modal-content">
                    <h2>Configurações</h2>
                    <div class="settings-grid">
                        <label><span>Exibir Grade</span><input type="checkbox" id="toggle-grid-cb" checked></label>
                        <label><span>Exibir Sangue</span><input type="checkbox" id="toggle-blood-cb" checked></label>
                        <label><span>Controles Mobile</span><input type="checkbox" id="toggleMobileControls"></label>
                        <label><span>Tela Cheia</span><input type="checkbox" id="toggle-fullscreen-cb"></label>
                    </div>
                    <button class="close-modal-btn">Fechar</button>
                </div>
            </div>
            
            <div id="mods-modal" class="game-modal">
                <div class="modal-content">
                    <h2>Mods</h2>
                    <p>A oficina de mods não está implementada.</p>
                    <button class="close-modal-btn">Fechar</button>
                </div>
            </div>

            <div id="environment-modal" class="game-modal">
                <div class="modal-content">
                    <h2>Controle de Ambiente</h2>
                    <button id="toggle-gravity-btn">Alternar Gravidade</button>
                    <button class="close-modal-btn">Fechar</button>
                </div>
            </div>

            <div id="info-modal" class="game-modal">
                 <div class="modal-content">
                    <h2>Informações e Controles</h2>
                    <ul>
                        <li><b>SHIFT + Arrastar:</b> Criar caixa de seleção.</li>
                        <li><b>B:</b> Detonar todos os C4s plantados.</li>
                        <li><b>R:</b> Atirar com arma / Ativar item selecionado.</li>
                        <li><b>P:</b> Alternar Câmera Lenta.</li>
                        <li><b>K:</b> Congelar/Descongelar objeto arrastado.</li>
                        <li><b>O:</b> Focar câmera no objeto arrastado.</li>
                        <li><b>[ e ]:</b> Controlar o zoom da câmera.</li>
                        <li><b>H:</b> Alternar modo Doador/Receptor em itens de líquido.</li>
                    </ul>
                    <button class="close-modal-btn">Fechar</button>
                </div>
            </div>

            <div id="save-modal" class="game-modal">
                <div class="modal-content">
                    <h2>Salvar Criação</h2>
                    <input type="text" id="save-name-input" placeholder="Nome da sua criação...">
                    <button id="save-contraption-btn">Salvar</button>
                    <button class="close-modal-btn">Cancelar</button>
                </div>
            </div>

             <div id="load-modal" class="game-modal">
                <div class="modal-content">
                    <h2>Carregar Criação</h2>
                    <div id="load-list"></div>
                    <button class="close-modal-btn">Fechar</button>
                </div>
            </div>

        </div>
    </div>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/matter-js/0.18.0/matter.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/poly-decomp/0.3.0/poly-decomp.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
